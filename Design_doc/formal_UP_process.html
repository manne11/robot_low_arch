<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-06-28 Fri 12:36 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org72e69f5">1. Formal document</a>
<ul>
<li><a href="#orgc5094eb">1.1. Glossary</a></li>
<li><a href="#org6297c4a">1.2. <span class="todo TODO">TODO</span> Requirements <code>[0%]</code></a>
<ul>
<li><a href="#org9318c02">1.2.1. <span class="todo TODO">TODO</span> Functional <code>[0%]</code></a></li>
<li><a href="#orgc4a16be">1.2.2. <span class="todo TODO">TODO</span> Non-Functional <code>[0%]</code></a></li>
</ul>
</li>
<li><a href="#org7bc55ff">1.3. <span class="todo TODO">TODO</span> User stories <code>[0%]</code></a></li>
<li><a href="#org45f1bcd">1.4. Domain modelling</a>
<ul>
<li><a href="#org62624cc">1.4.1. Activity diagrams modelling behaviour of system blocks(domain)</a></li>
<li><a href="#org3e2e974">1.4.2. event decomposition technique</a></li>
<li><a href="#org1f12718">1.4.3. event table</a></li>
<li><a href="#org15a25b5">1.4.4. Domain class diagram</a></li>
<li><a href="#org488a9a8">1.4.5. Use cases</a></li>
<li><a href="#org80e1e84">1.4.6. <span class="todo TODO">TODO</span> Sequence Diagram (add lifelines)</a></li>
</ul>
</li>
<li><a href="#org7ef1d2e">1.5. class diagram</a>
<ul>
<li><a href="#orge479606">1.5.1. Design class diagram</a></li>
<li><a href="#orgba5eb4b">1.5.2. Lifecycle state machine</a></li>
<li><a href="#org1a6ebe7">1.5.3. package diagram</a></li>
<li><a href="#org6c01a36">1.5.4. component</a></li>
<li><a href="#org75daa9d">1.5.5. protocol state machine</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgdbb26f5">2. <span class="todo TODO">TODO</span> </a></li>
</ul>
</div>
</div>


<div id="outline-container-org72e69f5" class="outline-2">
<h2 id="org72e69f5"><span class="section-number-2">1</span> Formal document</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgc5094eb" class="outline-3">
<h3 id="orgc5094eb"><span class="section-number-3">1.1</span> Glossary</h3>
<div class="outline-text-3" id="text-1-1">
<ol class="org-ol">
<li>Teensy: The unit(microcontroller) that houses the IMU and the LED contro for thr robot</li>
<li>IMU/Orientation unit: The unit in the teensy that provides data for orientation. It also provides data for velocity and acceleration</li>
<li>Drift: The IMU unit is susceptible to drifts. A drift involves the calculated value deviating from the true value.</li>
<li>Motor-controller: The motor controller is responsible for controlling and qyerying the state of the motor. It is the interface for the motor.</li>
<li>Orientation : The data that arrives from the IMU unit in the Teensy</li>
<li>Odometry: Odometry is an algorithm that calculates an estimate(predicts) of the position of the robot in the next instance of time(<sub>AMBIGUOS</sub>_: sergi suggests next sample instance) by taking in the velocity and the angular velocity.</li>
<li>Pose: A robots unit of position is the pose, it is a vector of x-cordinate, y-cordinate, and its angle of orientation(theta) represented as [x y theta]</li>
</ol>
</div>
</div>
<div id="outline-container-org6297c4a" class="outline-3">
<h3 id="org6297c4a"><span class="section-number-3">1.2</span> <span class="todo TODO">TODO</span> Requirements <code>[0%]</code></h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-org9318c02" class="outline-4">
<h4 id="org9318c02"><span class="section-number-4">1.2.1</span> <span class="todo TODO">TODO</span> Functional <code>[0%]</code></h4>
<div class="outline-text-4" id="text-1-2-1">
<ol class="org-ol">
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> utilize orientation and speed from Orientation unit and MotorController respectively when it is moving in a curved path .</li>
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> use the speed from the motor controller and the orientation set to previous state/null(depending on whether the robot just started operation; then null, else previous state) when the robot is moving in a straight line.</li>
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> do drift correction when the robot stops.</li>
</ol>
</div>
</div>

<div id="outline-container-orgc4a16be" class="outline-4">
<h4 id="orgc4a16be"><span class="section-number-4">1.2.2</span> <span class="todo TODO">TODO</span> Non-Functional <code>[0%]</code></h4>
<div class="outline-text-4" id="text-1-2-2">
</div>
<ol class="org-ol">
<li><a id="org19a0427"></a>Technical requirements<br />
<div class="outline-text-5" id="text-1-2-2-1">
<ol class="org-ol">
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> publish the data to a relevent topic</li>
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> set the speed for the motor.</li>
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> publish the data to a relevent topic.</li>
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> publish the data as a quarternian using the tf broadcast. x, y and use yaw value. The yaw shall be transformed to a quarternian.</li>
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> implement the algorithm for taking the velocity from the motor-controller and the Orientation data from the IMU sensor to estimate the pose,i.e [x y theta] of the robot</li>
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> publish the data to the navigation stack.</li>
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> include covarience in the odom pose messages.</li>
</ol>
</div>
</li>
<li><a id="orgdfba5fe"></a>Usability<br />
<div class="outline-text-5" id="text-1-2-2-2">
<ol class="org-ol">
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> provide a channel of communication for LED requests in the robot.</li>
</ol>
</div>
</li>
<li><a id="org38078f2"></a>Reliability<br />
<div class="outline-text-5" id="text-1-2-2-3">
<ol class="org-ol">
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> have a reboot functionality for Teensy</li>
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> query the state(alive or dead) of Teensy.</li>
</ol>
</div>
</li>
<li><a id="org84635d3"></a>Performance<br />
<div class="outline-text-5" id="text-1-2-2-4">
<ol class="org-ol">
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> use performance enhancements such as RT<sub>PREEMPT</sub>, CPU shielding, priority scheming. In essence there is a requirement for performance</li>
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> timestamp every sample of IMU and encoder data.</li>
<li class="off"><code>[&#xa0;]</code> The system <span class="underline">shall</span> measure jitter with the help of the timestamps of every samples of IMU and encoder data.</li>
</ol>
</div>
</li>
<li><a id="org9d34c65"></a>Supportability<br /></li>
</ol>
</div>
</div>
<div id="outline-container-org7bc55ff" class="outline-3">
<h3 id="org7bc55ff"><span class="section-number-3">1.3</span> <span class="todo TODO">TODO</span> User stories <code>[0%]</code></h3>
<div class="outline-text-3" id="text-1-3">
<ol class="org-ol">
<li class="off"><code>[&#xa0;]</code> The Teensy continuously publishes both IMU data and other (currently) irrelevent data. The IMU data is filtered for our purposes. <a id="org229dc4e"></a>. The orientation is captured from this data.  Each sample is timestamped and the difference in Timestamps is measured.</li>
<li class="off"><code>[&#xa0;]</code> When the robot stops. The program sends a command for drift correction to Teensy, when the robot moves, the program sends another command. This is like a complementary filter.</li>
<li class="off"><code>[&#xa0;]</code> The Motor controller has control over the motor. We send velocity commands to it in a periodic interval to make the motor run. The motor controller sends  speed periodically.</li>
<li class="off"><code>[&#xa0;]</code> The data from the /encoder/(speed) and the /IMU/(orientation) are fed to the odometry algorithm with the help of topics. The speed from the encoder is used when the robot is navigating in a straight line, but the IMU data is not used . When the robot is turning we start using the IMU to gather the orientation while the encoder speed is still used. It needs to accomplish two parts, publish the data with TF broadcast and publish the data to the navigation stack. The details of achieving the two tasks are explained in <a href="https://wiki.ros.org/navigation/Tutorials/RobotSetup/Odom">https://wiki.ros.org/navigation/Tutorials/RobotSetup/Odom</a></li>
</ol>
</div>
</div>


<div id="outline-container-org45f1bcd" class="outline-3">
<h3 id="org45f1bcd"><span class="section-number-3">1.4</span> Domain modelling</h3>
<div class="outline-text-3" id="text-1-4">
</div>
<div id="outline-container-org62624cc" class="outline-4">
<h4 id="org62624cc"><span class="section-number-4">1.4.1</span> Activity diagrams modelling behaviour of system blocks(domain)</h4>
<div class="outline-text-4" id="text-1-4-1">
</div>
<ol class="org-ol">
<li><a id="org9dfbe17"></a>straight line<br />
<div class="outline-text-5" id="text-1-4-1-1">

<div class="figure">
<p><img src="odometry_workflow_straightline.png" alt="odometry_workflow_straightline.png" />
</p>
</div>
</div>
</li>
<li><a id="org88d0695"></a>curve<br />
<div class="outline-text-5" id="text-1-4-1-2">

<div class="figure">
<p><img src="odometry_workflow_curve_1.png" alt="odometry_workflow_curve_1.png" />
</p>
</div>


<div class="figure">
<p><img src="odometry_workflow_curve_2.png" alt="odometry_workflow_curve_2.png" />
</p>
</div>
</div>
</li>
</ol>
</div>
<div id="outline-container-org3e2e974" class="outline-4">
<h4 id="org3e2e974"><span class="section-number-4">1.4.2</span> event decomposition technique</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
A technical document just before the use-cases, Identifying the elementary business process(EBP)
</p>
</div>
<ol class="org-ol">
<li><a id="orgb97dc10"></a>external events<br />
<div class="outline-text-5" id="text-1-4-2-1">
<ul class="org-ul">
<li class="on"><code>[X]</code> The data from Teensy comes in</li>
<li class="on"><code>[X]</code> the data from the motor controller with speed comes in</li>
</ul>
</div>
</li>

<li><a id="org1e17f81"></a>temporal events<br />
<div class="outline-text-5" id="text-1-4-2-2">
<ul class="org-ul">
<li class="on"><code>[X]</code> the command to move the motor with speed command is sent</li>
</ul>
</div>
</li>

<li><a id="orgc0c62ec"></a>state events<br />
<div class="outline-text-5" id="text-1-4-2-3">
<ul class="org-ul">
<li class="on"><code>[X]</code> when the robot stops, the drift correction command is sent to Teensy</li>
<li class="on"><code>[X]</code> when the robot moves, the robot moving command is sent.</li>
<li class="off"><code>[&#xa0;]</code> when the robot moves in a straight line the velocity is taken from the motor controller and the orientation is taken from the previous state and is kept constant.</li>
<li class="off"><code>[&#xa0;]</code> when the robot moves in a curved path the velocity is taken from the motor controller and the orientation is taken from the IMU.</li>
</ul>
</div>
</li>
</ol>
</div>



<div id="outline-container-org1f12718" class="outline-4">
<h4 id="org1f12718"><span class="section-number-4">1.4.3</span> event table</h4>
<div class="outline-text-4" id="text-1-4-3">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Event</th>
<th scope="col" class="org-left">Trigger</th>
<th scope="col" class="org-left">Source</th>
<th scope="col" class="org-left">Usecase</th>
<th scope="col" class="org-left">Response</th>
<th scope="col" class="org-left">Destination</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Teensy data comes in</td>
<td class="org-left">Teensy data</td>
<td class="org-left">Teensy</td>
<td class="org-left">process Teensy data</td>
<td class="org-left">provide Orientation</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Time to send motor speed command</td>
<td class="org-left">"every 5ms"</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">set motor speed</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Motor Controller</td>
</tr>

<tr>
<td class="org-left">Speed data comes in</td>
<td class="org-left">"every 3ms"</td>
<td class="org-left">Motor-controller</td>
<td class="org-left">Process speed for Odometry</td>
<td class="org-left">provide odometry estimation</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Robot stops</td>
<td class="org-left">robot stopped</td>
<td class="org-left">(internal state)</td>
<td class="org-left">provide drift correction</td>
<td class="org-left">command to correct drift</td>
<td class="org-left">Teensy</td>
</tr>

<tr>
<td class="org-left">Robot moves after stopping</td>
<td class="org-left">robot moves after stop</td>
<td class="org-left">(internal state)</td>
<td class="org-left">update after drift correction</td>
<td class="org-left">command to move after correct.</td>
<td class="org-left">Teensy</td>
</tr>

<tr>
<td class="org-left">Robot moves in a straight line</td>
<td class="org-left">robot moves straight</td>
<td class="org-left">(internal state)</td>
<td class="org-left">process velocity fix orientation</td>
<td class="org-left">utilize velocity</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Robot moves in a curved path</td>
<td class="org-left">robot moves in a curve</td>
<td class="org-left">(internal state)</td>
<td class="org-left">process velocity process orientation</td>
<td class="org-left">utilize velocity and orientation</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org15a25b5" class="outline-4">
<h4 id="org15a25b5"><span class="section-number-4">1.4.4</span> Domain class diagram</h4>
<div class="outline-text-4" id="text-1-4-4">
<p>
Models the domain as seen from the designer, Note that all the domain classes have a multiplicity of 1
</p>

<div class="figure">
<p><img src="domain_model.png" alt="domain_model.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org488a9a8" class="outline-4">
<h4 id="org488a9a8"><span class="section-number-4">1.4.5</span> Use cases</h4>
<div class="outline-text-4" id="text-1-4-5">
<ol class="org-ol">
<li><p>
process robot path:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">process robot path</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><span class="underline">Brief description</span>:</td>
</tr>

<tr>
<td class="org-left">Processes that occur when a robot moves in a curved or straight</td>
</tr>

<tr>
<td class="org-left">path</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><span class="underline">Primary actors</span>:</td>
</tr>

<tr>
<td class="org-left">1. MotorController</td>
</tr>

<tr>
<td class="org-left">2. Teensy</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><span class="underline">PreConditions</span>:</td>
</tr>

<tr>
<td class="org-left">1. Teensy is publishing data continuosly</td>
</tr>

<tr>
<td class="org-left">2. The data published contains Orientation data</td>
</tr>

<tr>
<td class="org-left">4. The port to access Teensy is open</td>
</tr>

<tr>
<td class="org-left">5. The motor is functional.</td>
</tr>

<tr>
<td class="org-left">6. The motor controller is functional.</td>
</tr>

<tr>
<td class="org-left">7. The motor controller responds to user requests</td>
</tr>

<tr>
<td class="org-left">8. The port to access motor Controller is open.</td>
</tr>

<tr>
<td class="org-left">9. Speed data is continuosly being sent from the motorController</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><span class="underline">PostConditions</span>:</td>
</tr>

<tr>
<td class="org-left">1. The Odometry algorithm makes a pose estimate for the future</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><span class="underline">Main Scenario</span>:</td>
</tr>

<tr>
<td class="org-left">1. When the timer condition of 3ms expires the motor controller</td>
</tr>

<tr>
<td class="org-left">is requested to set the speed of the motor.</td>
</tr>

<tr>
<td class="org-left">2. When a condition is detected that the robot moves in a curved</td>
</tr>

<tr>
<td class="org-left">path, the current orientation and speed are used from the</td>
</tr>

<tr>
<td class="org-left">orietation unit and MotorController respectively.</td>
</tr>

<tr>
<td class="org-left">3. The odometry and speed are passed as inputs to the odometry</td>
</tr>

<tr>
<td class="org-left">algorithm</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><span class="underline">Alternative Scenario :</span></td>
</tr>

<tr>
<td class="org-left">2.a. When the robot just initiates its movement, we set either</td>
</tr>

<tr>
<td class="org-left">the value of orientation to zero or some pre-determined value.</td>
</tr>

<tr>
<td class="org-left">Speed is taken from the motor controller.</td>
</tr>

<tr>
<td class="org-left">2.b. When the condition is detected that the robot moves in a</td>
</tr>

<tr>
<td class="org-left">straight line the value used for orientation is from the state</td>
</tr>

<tr>
<td class="org-left">just before the robot started moving straight.</td>
</tr>
</tbody>
</table></li>

<li><p>
Correct Drift in Orientation:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Correct drift in Orientation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><span class="underline">Brief description</span>:</td>
</tr>

<tr>
<td class="org-left">The robot corrects the drift in the IMU unit in Teensy</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><span class="underline">Primary actors</span>:</td>
</tr>

<tr>
<td class="org-left">Teensy</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><span class="underline">PreConditions</span>:</td>
</tr>

<tr>
<td class="org-left">1. The robot has stopped its movement</td>
</tr>

<tr>
<td class="org-left">2. Teensy is functional</td>
</tr>

<tr>
<td class="org-left">3. Teensy is publishing orientation data to the respective</td>
</tr>

<tr>
<td class="org-left">port</td>
</tr>

<tr>
<td class="org-left">4. The port to which Teensy is connected is functional</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><span class="underline">PostConditions</span>:</td>
</tr>

<tr>
<td class="org-left">1. Drift is corrected in the orientation unit.</td>
</tr>

<tr>
<td class="org-left">2. Robot resumes movement.</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><span class="underline">Main Scenario</span>:</td>
</tr>

<tr>
<td class="org-left">1. Drift is corrected in the orientation unit.</td>
</tr>

<tr>
<td class="org-left">2. Robot resumes movement.</td>
</tr>
</tbody>
</table></li>
</ol>
</div>

<ol class="org-ol">
<li><a id="orgf7a5066"></a>Usecase to requirement matrix<br />
<div class="outline-text-5" id="text-1-4-5-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">R1</td>
<td class="org-left">R2</td>
<td class="org-left">R3</td>
</tr>

<tr>
<td class="org-left">UC1</td>
<td class="org-left">*</td>
<td class="org-left">*</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">UC2</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">*</td>
</tr>
</tbody>
</table>
</div>
</li>

<li><a id="orgf47fad3"></a>Usecase Diagram<br />
<div class="outline-text-5" id="text-1-4-5-2">

<div class="figure">
<p><img src="UsecaseDiagram.png" alt="UsecaseDiagram.png" />
</p>
</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-org80e1e84" class="outline-4">
<h4 id="org80e1e84"><span class="section-number-4">1.4.6</span> <span class="todo TODO">TODO</span> Sequence Diagram (add lifelines)</h4>
<div class="outline-text-4" id="text-1-4-6">
<ul class="org-ul">
<li><p>
Robots movement in Curved Path
</p>

<div class="figure">
<p><img src="CurvedPath.png" alt="CurvedPath.png" />
</p>
</div></li>

<li><p>
Robots movement in Straight Path
</p>

<div class="figure">
<p><img src="StraightPath.png" alt="StraightPath.png" />
</p>
</div></li>

<li><p>
Robot started operation 
</p>

<div class="figure">
<p><img src="StartedOperation.png" alt="StartedOperation.png" />
</p>
</div></li>
</ul>


<ul class="org-ul">
<li><p>
correcting drift 
</p>

<div class="figure">
<p><img src="DriftCorrection.png" alt="DriftCorrection.png" />
</p>
</div></li>
</ul>
</div>


<ol class="org-ol">
<li><a id="org78919e4"></a>sequence diagram to Usecase matrix<br />
<div class="outline-text-5" id="text-1-4-6-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">UC1</td>
<td class="org-left">UC2</td>
</tr>

<tr>
<td class="org-left">S1</td>
<td class="org-left">*</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">S2</td>
<td class="org-left">*</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">S3</td>
<td class="org-left">*</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">S4</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">*</td>
</tr>
</tbody>
</table>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org7ef1d2e" class="outline-3">
<h3 id="org7ef1d2e"><span class="section-number-3">1.5</span> class diagram</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-orge479606" class="outline-4">
<h4 id="orge479606"><span class="section-number-4">1.5.1</span> Design class diagram</h4>
<div class="outline-text-4" id="text-1-5-1">

<div class="figure">
<p><img src="designClassDiagram.png" alt="designClassDiagram.png" />
</p>
</div>
</div>
</div>


<div id="outline-container-orgba5eb4b" class="outline-4">
<h4 id="orgba5eb4b"><span class="section-number-4">1.5.2</span> Lifecycle state machine</h4>
<div class="outline-text-4" id="text-1-5-2">
</div>
<ol class="org-ol">
<li><a id="org16041ff"></a>TranslationUnit<br />
<div class="outline-text-5" id="text-1-5-2-1">
<p>
remember that although teleop is setting the speed, it is the motor that turns it and hence linear<sub>velocity</sub> and angular<sub>velocity</sub> should be calculated according to that reported by the motorcontroller rather than the one set by the teleop
</p>

<div class="figure">
<p><img src="LSMTranslationUnit.png" alt="LSMTranslationUnit.png" />
</p>
</div>
</div>
</li>

<li><a id="org167355c"></a>Odometry<br />
<div class="outline-text-5" id="text-1-5-2-2">

<div class="figure">
<p><img src="LSMOdometry.png" alt="LSMOdometry.png" />
</p>
</div>
</div>
</li>

<li><a id="orgbd02f3e"></a>OrientationUnit<br />
<div class="outline-text-5" id="text-1-5-2-3">

<div class="figure">
<p><img src="LSMOrientationUnit.png" alt="LSMOrientationUnit.png" />
</p>
</div>
</div>
</li>
</ol>
</div>


<div id="outline-container-org1a6ebe7" class="outline-4">
<h4 id="org1a6ebe7"><span class="section-number-4">1.5.3</span> package diagram</h4>
<div class="outline-text-4" id="text-1-5-3">

<div class="figure">
<p><img src="packageDiagram.png" alt="packageDiagram.png" />
</p>
</div>
</div>
</div>





<div id="outline-container-org6c01a36" class="outline-4">
<h4 id="org6c01a36"><span class="section-number-4">1.5.4</span> component</h4>
</div>

<div id="outline-container-org75daa9d" class="outline-4">
<h4 id="org75daa9d"><span class="section-number-4">1.5.5</span> protocol state machine</h4>
</div>
</div>
</div>

<div id="outline-container-orgdbb26f5" class="outline-2">
<h2 id="orgdbb26f5"><span class="section-number-2">2</span> <span class="todo TODO">TODO</span> </h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>plantuml has timing diagrams use them</li>
<li>remember that floating point values are hard to compare, try rounding them off</li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2019-06-28 Fri 12:36</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
